<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>Preloader Plugin for Images, using jQuery</title>

	<link rel="stylesheet" href="//yui.yahooapis.com/pure/0.2.1/pure-min.css">
	<link rel="stylesheet" href="css/main.css">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

	<style>
		body { font-family: sans-serif;}
		a {
			color: #4183c4;
			font-size: 15px;
		}
		.container {
			clear:both;
			margin:20px 0;
		}
		.container img {
		  width:200px;
		  vertical-align: bottom;
		}
		.loadbar {
			overflow: hidden;
			width:100%;
			height: 20px;
			background: orange;
		}

		.individual {
			float:left;
			width:20px;
			height:20px;
			background-color: yellowgreen;
			box-shadow:-1px 0 0 1px rgba(255,255,255,0.2);
		}
	</style>

</head>
<body>
  <div>
    <div class="header">
        <div class="pure-menu pure-menu-open pure-menu-horizontal">
            <a class="pure-menu-heading" href="">Preload Images Plugin</a>

            <ul>
                <li class="pure-menu-selected"><a href="/">Demo</a></li>
                <li><a href="https://raw.github.com/laantorchaweb/preloader/master/preloader.js">Download</a></li>
                <li><a href="https://github.com/laantorchaweb/preloader">Contribute</a></li>
            </ul>
        </div>
    </div>

    <div class="pure-g-r">
        <div class="pure-u-1-3 photo-box">
			<img id="img-1" class="image" src="" alt="1" data-desktop="img/samurai-06.jpg" data-mobile="img/ninja-02.jpg" data-slider="false">
        </div>

        <div class="pure-u-2-3 text-box">
            <div class="l-box">
            	<div class="status">
					<div class="loadbar"></div>
				</div>
                <h1 class="text-box-head">Image Preloading jQuery Plugin</h1>
                <div id="loaded-text">
                	<p class="text-box-subhead">All images have been loaded.</p>
                	<p>This is a jquery plugin for pre loading images, you have a callback for each one that it loads and when all have been loaded. It works by grabbing the src of the image in a custom data attribute. This comes in handy when you want to display smaller images on mobile for example. Or maybe you only want to load the images when the user is scrolling down, or when triggers some event.</p>

                	<p>Try it out by resising the browser window to a smaller size and refresh the page, or click the button below:</p>
                	<button id="change-images" class="pure-button pure-button-primary" data-target="mobile">Change Images</button>
                </div>
            </div>
        </div>

        <div class="pure-u-2-3 photo-box">
            <img id="img-4" class="image" src="" alt="4" data-desktop="img/samurai-08.jpg" data-mobile="img/ninja-03.jpg" data-slider="false">
        </div>
        <div class="pure-u-1-3 photo-box">
            <img id="img-2" class="image" src="" alt="2" data-desktop="img/samurai-05.jpg" data-mobile="img/ninja-01.jpg" data-slider="false">
        </div>

        <div class="pure-u-1-3 photo-box">
            <img id="img-3" class="image" src="" alt="3" data-desktop="img/samurai-02.jpg" data-mobile="img/ninja-09.jpg" data-slider="false">
        </div>

		<div class="pure-u-2-3 photo-box">
			<img id="img-8" class="image" src="" alt="8" data-desktop="img/samurai-07.jpg" data-mobile="img/ninja-05.jpg" data-slider="false">
		</div>

		<div class="pure-u-2-3 photo-box">
			<img id="img-9" class="image" src="" alt="9" data-desktop="img/samurai-03.jpg" data-mobile="img/ninja-04.jpg" data-slider="false">
		</div>

        <div class="pure-u-1-3 photo-box">
            <img id="img-6" class="image" src="" alt="6" data-desktop="img/samurai-01.jpg" data-mobile="img/ninja-07.jpg" data-slider="false">
        </div>



        <div class="pure-u-1">
            <div class="l-box">
                <h2>Using the plugin</h2>

                <p>By default the plugin will hide the images that you passed but that don't have the data attribute. This is useful for images that you don't want to show in the mobile site. If you prefer to display those empty tags you can set hideIfNoData to false when calling the plugin. </p>
            </div>
        </div>
    </div>

    <div class="footer">
        @laantorcha - laantorcha.net - github.com/laantorchaweb
    </div>
  </div>
<script src="preloader.js"></script>
<script>

	$(function(){

		var dataName = 'desktop';

		if ( $(window).width() <= 480  ) {
			dataName = 'mobile'; // You can have several data attributes pointing to diferrent image sizes
			$('#change-images').data('target', 'desktop');
		}

		var total = $('.image').filter('[data-' + dataName + ']').length; // Filter by data type to create the loading bar

		$('.loadbar').css({
			width: total * 20
		})

		// Initialize the plugin

		$('.image').preloader({

			data: dataName, // this is the data attr that contains the url you wan to load

			each: function() {

				// inside the "each" function "this" is the loaded image

				$(this).hide().fadeIn();

				$('<div />', {
					'class': 'individual'
				}).prependTo('.loadbar');
			},

			all: function() {

				// $(this).each(function() {

					// inside the "all" function "this" is an array with all jquery image objects

				  	// console.log(this);
				// });
				console.log('all images have been loaded');
				$('#loaded-text').fadeIn();

			}

		});

		$('#change-images').on('click', function() {
			var $this  = $(this),
				target = $this.data('target');

			$('.individual', '.loadbar').remove();

			$('.image').preloader({
				data: target,

				each: function() {
					$('<div />', {
						'class': 'individual'
					}).prependTo('.loadbar');
				}
			});

			if( target === 'mobile') {

				$this.data('target', 'desktop')

			} else {

				$this.data('target', 'mobile')

			}

		});

	});

</script>
</body>
</html>
